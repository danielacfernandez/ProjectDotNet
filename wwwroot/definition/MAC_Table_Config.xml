<?xml version="1.0" encoding="utf-8"?>
<config EngineVersion="1.0.2.25">
    <version number="1.0.0.180" author="" dateCreation="2020-03-27" dateLastChange="2022-04-07"></version>
    <connectionString></connectionString>
    <grid>
        <viewType>grid</viewType>
        <pageSize>50</pageSize>
        <fixedColumns>0</fixedColumns>
        <title>MAC Report Table Config</title>
        <defaultOrder>Sequence</defaultOrder>
        <templateEdit style=""><![CDATA[]]></templateEdit>
        <allowExport>True</allowExport>
        <allowFullScreen>True</allowFullScreen>
        <allowCustomization>True</allowCustomization>
        <refreshGridAfterSaveRecord>False</refreshGridAfterSaveRecord>
        <allowPageSizeSelection>True</allowPageSizeSelection>
        <allowPageSelection>True</allowPageSelection>
        <allowMultipleSelection>False</allowMultipleSelection>
        <defaultMultipleSelection>False</defaultMultipleSelection>
        <displayRowCursor>True</displayRowCursor>
        <sqlSelect><![CDATA[SELECT
	MTC.ID AS TableID,
	MTC.ReportID AS TableReportID,
	MRC.EndUserID as EndUserID,
	MTC.Sequence,
	MTC.CostCenterID,
	LTRIM(RTRIM(C.Customer_Name)) + ' - ' + CCL.LIST_VALUE AS CostCenterName,
	MTC.GroupingFieldID,
	CASE MTC.GroupingFieldID 
		WHEN 0 THEN 'Work Order Number'
		WHEN 1 THEN 'Building'
		WHEN 2 THEN 'Location'
		WHEN 3 THEN 'Job Location' 
	END AS GroupingFieldName,
	MTC.IsActive
	
FROM MAC_Table_Config MTC (nolock)
INNER JOIN MAC_Report_Config MRC (nolock)
	ON MTC.ReportID = MRC.ID
LEFT JOIN CUSTOM_COL_LISTS CCL (nolock)
	ON CCL.CUSTOM_COL_LIST_ID = MTC.CostCenterID
LEFT JOIN CUSTOM_CUST_COLUMNS CCC (nolock)
	ON CCL.CUSTOM_CUST_COL_ID = CCC.CUSTOM_CUST_COL_ID
LEFT JOIN dbo.CUSTOMERS C
	ON C.CUSTOMER_ID = CCC.CUSTOMER_ID
WHERE MTC.ReportID = @ReportID]]>
<parameters /></sqlSelect>
        <sqlUpdate where="[TableID]=@TableID" autoUpdateQuery="False" updateTable=""><![CDATA[UPDATE MAC_Table_Config SET
	ReportID = @TableReportID,
	Sequence = @Sequence,
	CostCenterID = @CostCenterID,
	GroupingFieldID = @GroupingFieldID,
	ModifiedOn = GETUTCDATE(),
	ModifiedBy = @__UserId__,
	IsActive = @IsActive
WHERE ID=@TableID]]></sqlUpdate>
        <sqlInsert where="[TableID]=@@IDENTITY"><![CDATA[INSERT INTO MAC_Table_Config (ReportID, Sequence, CostCenterID, GroupingFieldID, CreatedOn, CreatedBy, IsActive) VALUES (
	@ReportID,
	@Sequence,
	@CostCenterID,
	@GroupingFieldID,
	GETUTCDATE(),
	@__UserId__,
	@IsActive
)]]></sqlInsert>
        <sqlDelete><![CDATA[DELETE FROM MAC_Table_Config
WHERE ID=@TableID]]></sqlDelete>
        <buttons>
<button id="cmdOpenMACReportCategoryConfig" actionType="openGrid" gridToOpen="MAC_Category_Config" icon="fa-solid fa-sitemap" title="Open MAC Report Category Config" label="Open MAC Report Category Config" target="popUp" sqlParameters="" confirmationMessage="" multiselect="False" refreshDataAfterExecution="True" url="">
<sqlSentence><![CDATA[]]></sqlSentence></button></buttons>
        <columns>
<column id="TableID" label="ID" width="50" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="right" headerAlign="right" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="10"></column>
<column id="TableReportID" label="ReportID" width="50" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="right" headerAlign="right" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="10"></column>
<column id="EndUserID" label="EndUserID" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="right" headerAlign="right" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="Sequence" label="Sequence" width="75" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="right" headerAlign="right" editorType="textbox" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="CostCenterID" label="Cost Center" width="200" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="listbox" visible="True" format="" labelField="CostCenterName" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="10">
<dataSelect><![CDATA[SELECT TOP 100 PERCENT 
	CCL.CUSTOM_COL_LIST_ID AS CostCenterID, 
	LTRIM(RTRIM(C.Customer_Name)) + ' - ' + CCL.LIST_VALUE AS CostCenterName
FROM CUSTOM_CUST_COLUMNS CCC (nolock)
INNER JOIN CUSTOM_COL_LISTS CCL (nolock)
	ON CCL.CUSTOM_CUST_COL_ID = CCC.CUSTOM_CUST_COL_ID
INNER JOIN dbo.CUSTOMERS C (nolock)
	ON C.CUSTOMER_ID = CCC.CUSTOMER_ID
WHERE CCC.ACTIVE_FLAG = 'Y'
	AND CCL.ACTIVE_FLAG = 'Y'
	AND CCC.IS_DROPLIST = 'Y'
	AND CCC.COLUMN_DESC = 'Cost Center'
	AND (@EndUserID IS NULL OR CCC.CUSTOMER_ID = (SELECT end_user_parent_id FROM dbo.CUSTOMERS WHERE CUSTOMER_ID = @EndUserID))
ORDER BY CostCenterName, CostCenterID]]></dataSelect></column>
<column id="CostCenterName" label="CostCenterName" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="False" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="GroupingFieldID" label="Grouping Field" width="150" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="listbox" visible="True" format="" labelField="GroupingFieldName" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="50">
<dataSelect><![CDATA[SELECT 0 AS GroupingFieldID, 'Work Order Number' AS GroupingFieldName
UNION ALL
SELECT 1, 'Building'
UNION ALL
SELECT 2, 'Location'
UNION ALL
SELECT 3, 'Job Location']]></dataSelect></column>
<column id="GroupingFieldName" label="GroupingFieldName" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="False" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="IsActive" label="Is Active" width="50" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="center" headerAlign="center" editorType="checkbox" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column></columns>
        <sqlColumns><![CDATA[]]></sqlColumns>
        <sqlTemplateEdit><![CDATA[]]></sqlTemplateEdit>
        <sqlGridProperties><![CDATA[]]></sqlGridProperties>
    </grid>
</config>