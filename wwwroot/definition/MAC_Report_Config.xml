<?xml version="1.0" encoding="utf-8"?>
<config EngineVersion="1.0.2.25">
    <version number="1.0.0.170" author="NDR" dateCreation="2020-03-27" dateLastChange="2022-04-07"></version>
    <connectionString></connectionString>
    <grid>
        <viewType>grid</viewType>
        <pageSize>50</pageSize>
        <fixedColumns>0</fixedColumns>
        <title>MAC Report Config</title>
        <defaultOrder>ReportID</defaultOrder>
        <templateEdit style=""><![CDATA[]]></templateEdit>
        <allowExport>True</allowExport>
        <allowFullScreen>True</allowFullScreen>
        <allowCustomization>True</allowCustomization>
        <refreshGridAfterSaveRecord>False</refreshGridAfterSaveRecord>
        <allowPageSizeSelection>True</allowPageSizeSelection>
        <allowPageSelection>True</allowPageSelection>
        <allowMultipleSelection>False</allowMultipleSelection>
        <defaultMultipleSelection>False</defaultMultipleSelection>
        <displayRowCursor>True</displayRowCursor>
        <sqlSelect><![CDATA[SELECT
	MRC.ID AS ReportID,
	MRC.EndUserID,
	CAST(C.Organization_Id AS VARCHAR(2))+' - '+C.Customer_Name AS EndUserName,
	MRC.ReportTitle,
	MRC.LogoLeftId,
	MLC_Left.LogoLabel AS LogoLeftLabel,
	MRC.LogoRightId,
	MLC_Right.LogoLabel AS LogoRightLabel,
	MRC.IsActive
FROM MAC_Report_Config MRC (nolock)
LEFT JOIN dbo.MAC_Logo_Config MLC_Left (nolock)
	ON MLC_Left.Id = MRC.LogoLeftId
LEFT JOIN dbo.MAC_Logo_Config MLC_Right (nolock)
	ON MLC_Right.Id = MRC.LogoRightId
LEFT JOIN dbo.Customers C (nolock)
    on c.customer_id = MRC.EndUserID]]>
<parameters /></sqlSelect>
        <sqlUpdate where="[ReportID]=@ReportID" autoUpdateQuery="False" updateTable=""><![CDATA[UPDATE MAC_Report_Config SET
	EndUserID = @EndUserID,
	ReportTitle = @ReportTitle,
	LogoLeftId = @LogoLeftId,
	LogoRightId = @LogoRightId,
	ModifiedOn = GETUTCDATE(),
	ModifiedBy = @__UserId__,
	IsActive = @IsActive
WHERE ID = @ReportID]]></sqlUpdate>
        <sqlInsert where="[ReportID]=@@IDENTITY"><![CDATA[INSERT INTO MAC_Report_Config (EndUserID, ReportTitle, LogoLeftId, LogoRightId, CreatedOn, CreatedBy, IsActive) VALUES (
	@EndUserID,
	@ReportTitle,
	@LogoLeftId,
	@LogoRightId,
	GETUTCDATE(),
	@__UserId__,
	@IsActive
)]]></sqlInsert>
        <sqlDelete><![CDATA[DELETE FROM MAC_Report_Config
WHERE ID = @ReportID]]></sqlDelete>
        <buttons>
<button id="cmdOpenMACReportTableConfig" actionType="openGrid" gridToOpen="MAC_Table_Config" icon="fa-solid fa-sitemap" title="Open MAC Report Table Config" label="Open MAC Report Table Config" target="popUp" sqlParameters="" confirmationMessage="" multiselect="False" refreshDataAfterExecution="True" url="">
<sqlSentence><![CDATA[]]></sqlSentence></button></buttons>
        <columns>
<column id="ReportID" label="ID" width="50" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="right" headerAlign="right" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="10"></column>
<column id="ReportTitle" label="Report Title" width="250" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="200"></column>
<column id="EndUserID" label="End User" width="250" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="listbox" visible="True" format="" labelField="EndUserName" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="10">
<dataSelect><![CDATA[SELECT DISTINCT TOP 100 PERCENT 
	P.END_USER_ID AS EndUserID, 
	CAST(C.Organization_Id AS VARCHAR(2))+' - '+C.CUSTOMER_NAME AS EndUserName
FROM dbo.PROJECTS P (nolock)
inner join dbo.Lookups_Active_V LP (nolock)
	on LP.LOOKUP_ID = P.PROJECT_TYPE_ID
inner join dbo.CUSTOMERS C (nolock)
	on P.END_USER_ID = C.CUSTOMER_ID
WHERE ISNULL(C.ext_customer_id,'') NOT LIKE 'OLD%'
AND LP.type_code = 'job_type'
and LP.lookup_code = 'service_account'
AND C.ACTIVE_FLAG = 'Y'
AND C.end_user_parent_id IS NOT NULL
ORDER BY EndUserName, EndUserID]]></dataSelect></column>
<column id="EndUserName" label="EndUserName" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="False" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="LogoLeftId" label="Left Logo" width="150" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="listbox" visible="True" format="" labelField="LogoLeftLabel" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="250">
<dataSelect><![CDATA[
SELECT ID AS LogoLeftId, LogoLabel AS LogoLeftLabel
FROM [dbo].[MAC_Logo_Config] (nolock)
WHERE [IsActive] = 1
]]></dataSelect>
</column>
<column id="LogoLeftLabel" label="LogoLeftLabel" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="False" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="LogoRightId" label="Right Logo" width="150" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="listbox" visible="True" format="" labelField="LogoRightLabel" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="250">
<dataSelect><![CDATA[
SELECT ID AS LogoRightId, LogoLabel AS LogoRightLabel
FROM [dbo].[MAC_Logo_Config] (nolock)
WHERE [IsActive] = 1
]]></dataSelect>
</column>
<column id="LogoRightLabel" label="LogoRightLabel" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="False" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="IsActive" label="Is Active" width="50" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="center" headerAlign="center" editorType="checkbox" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column></columns>
        <sqlColumns><![CDATA[]]></sqlColumns>
        <sqlTemplateEdit><![CDATA[]]></sqlTemplateEdit>
        <sqlGridProperties><![CDATA[]]></sqlGridProperties>
    </grid>
</config>