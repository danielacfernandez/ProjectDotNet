<?xml version="1.0" encoding="utf-8"?>
<config EngineVersion="1.0.2.25">
    <version number="1.0.0.92" author="" dateCreation="2020-04-30" dateLastChange="2022-09-16"></version>
    <connectionString></connectionString>
    <grid>
        <viewType>grid</viewType>
        <pageSize>50</pageSize>
        <fixedColumns>0</fixedColumns>
        <title>Billing Detail</title>
        <defaultOrder>BILL_JOB_NO</defaultOrder>
        <templateEdit style=""><![CDATA[]]></templateEdit>
        <allowExport>True</allowExport>
        <allowFullScreen>False</allowFullScreen>
        <allowCustomization>True</allowCustomization>
        <refreshGridAfterSaveRecord>True</refreshGridAfterSaveRecord>
        <allowPageSizeSelection>True</allowPageSizeSelection>
        <allowPageSelection>True</allowPageSelection>
        <allowMultipleSelection>True</allowMultipleSelection>
        <defaultMultipleSelection>True</defaultMultipleSelection>
        <displayRowCursor>True</displayRowCursor>
        <sqlSelect><![CDATA[select 
        TS.BILL_JOB_ID,
	TS.BILL_SERVICE_NO, 
	dbo.udf_StripHTML(TS.SERVICE_DESCRIPTION) AS SERVICE_DESCRIPTION, 
	TS.BILL_SERVICE_ID, 
	TS.BILL_SERVICE_LINE_NO, 
	TS.SERVICE_LINE_ID, 
        TS.INVOICE_LINE_ID,
	TS.PO_NO, 
	TS.SERVICE_LINE_DATE_VARCHAR,  
	I.NAME AS ITEM_NAME,
	TS.ITEM_ID, 
	TS.RESOURCE_NAME,
	TS.SUM_PAYROLL_QTY, 
	CASE WHEN TS.BILL_EXP_TOTAL > 0 THEN TS.sum_bill_exp_qty ELSE TS.BILL_QTY END AS BILL_QTY, 
	TS.BILL_RATE, 
	TS.SUM_BILL_EXP_QTY, 
	TS.BILL_JOB_NO,
	TS.BILL_HOURLY_TOTAL, 
	TS.BILL_EXP_TOTAL, 
	TS.BILL_TOTAL, 
	TS.QUOTED_TOTAL, 
	TS.INVOICE_ID,
	cast( TS.BILL_JOB_NO as varchar) as JOB_REQUEST_LINK,	
	'<a href="#" onclick="openRequest('+cast(TS.LASTREQUEST_ID as varchar)+')">' + cast( TS.BILL_SERVICE_NO as varchar) + '</a>' as JOB_LASTREQUEST_LINK,
        TS.DATE_CREATED, TS.CREATED_BY, TS.DATE_MODIFIED, TS.MODIFIED_BY, TS.CreatedByUserName, TS.ModifiedByUserName, BillingComment, item_type_code,
		request_name
from 
	dbo.Invoicing_GetBillingLinesByDetail_FN(@JOBID,NULL,@ISBILLABLE,NULL,(SELECT TOP 1 USERID FROM DBO.ASPNETUSERS WHERE USERNAME = @__LoginID__)) TS
left join 
	dbo.ITEMS I  
on
	TS.ITEM_ID = I.ITEM_ID]]>
<parameters /></sqlSelect>
        <sqlUpdate where="" autoUpdateQuery="False" updateTable=""><![CDATA[declare @useridval bigint; select @useridval=UserId from dbo.AspNetUsers 
where username = @__LoginId__; 
if isnull(cast(@ITEM_ID as varchar(30)), '') <> ''
begin
if isnull(@SERVICE_LINE_ID, 0) <> 0
UPDATE DBO.SERVICE_LINES SET BILL_RATE = CAST(@BILL_RATE AS NUMERIC(18,2)), BILL_QTY = @BILL_QTY,
ITEM_ID = CAST(@ITEM_ID AS NUMERIC(18,2)),
 DATE_MODIFIED = CURRENT_TIMESTAMP
			, MODIFIED_BY = @useridval,  billingComment  = case when isnull(@ITEM_TYPE_CODE, '') = 'expense' then @BILLINGCOMMENT else billingComment end
			WHERE SERVICE_LINE_ID = CAST(@SERVICE_LINE_ID AS NUMERIC(18,0))
else
UPDATE DBO.invoice_lines SET UNIT_PRICE = CAST(@BILL_RATE AS NUMERIC(18,2)), QTY = @BILL_QTY,
ITEM_ID = CAST(@ITEM_ID AS NUMERIC(18,2)),
 DATE_MODIFIED = CURRENT_TIMESTAMP
			, MODIFIED_BY = @useridval 
			WHERE INVOICE_LINE_ID = CAST(@INVOICE_LINE_ID AS NUMERIC(18,0))
end]]></sqlUpdate>
        <sqlInsert where=""><![CDATA[]]></sqlInsert>
        <sqlDelete><![CDATA[if isnull(@SERVICE_LINE_ID, 0) <> 0
delete from DBO.SERVICE_LINES 
WHERE SERVICE_LINE_ID = CAST(@SERVICE_LINE_ID AS NUMERIC(18,0))
and ITEM_TYPE_CODE = 'expense' and invoice_id is null]]></sqlDelete>
        <buttons>
<button id="cmdInvoice" actionType="executeSQL" gridToOpen="" icon="fa fa-usd" title="Assign to Invoice" label="Assign to Invoice" target="" sqlParameters="SERVICE_LINE_ID" confirmationMessage="" multiselect="True" refreshDataAfterExecution="True" url="">
<sqlSentence><![CDATA[
					declare @VARCHARTable as VARCHARIDTABLETYPE
					insert into @VARCHARTable (ID) select cast(SERVICE_LINE_ID as varchar) from @SERVICE_LINE_ID 	
					EXEC [Billing_InvoiceServiceLines_Update]  @VARCHARTable, 'DETAIL', @INVOICEID, @__LoginId__ 
				]]></sqlSentence></button>
<button id="cmdBillable" actionType="executeSQL" gridToOpen="" icon="fa fa-check-square" title="Toggle Billability" label="Toggle Billability" target="" sqlParameters="SERVICE_LINE_ID" confirmationMessage="" multiselect="True" refreshDataAfterExecution="True" url="">
<sqlSentence><![CDATA[
					declare @VARCHARTable as VARCHARIDTABLETYPE
					DECLARE @V_ISBILLABLE VARCHAR(5)
					SET @V_ISBILLABLE = (SELECT CASE WHEN @ISBILLABLE = 'Y' THEN 'N' ELSE 'Y' END)
					insert into @VARCHARTable (ID) select cast(SERVICE_LINE_ID as varchar) from @SERVICE_LINE_ID 	
					EXEC [Billing_ServiceLinesBillable_Update]  @VARCHARTable, 'DETAIL', @V_ISBILLABLE, @__LoginId__ 
				]]></sqlSentence></button>
<button id="cmdMoveLines" actionType="gotoUrl" gridToOpen="" icon="" title="" label="Move Lines" target="blank" sqlParameters="" confirmationMessage="" multiselect="True" refreshDataAfterExecution="True" url="">
<sqlSentence><![CDATA[]]></sqlSentence></button></buttons>
        <columns>
<column id="JOB_REQUEST_LINK" label="Job #" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="html" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="BILL_JOB_NO" label="Job # (hidden)" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textarea" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="200"></column>
<column id="JOB_LASTREQUEST_LINK" label="Req#" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="html" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="Request_name" label="Request Name" width="275" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="200"></column>
<column id="BILL_SERVICE_NO" label="Req# (hidden)" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="10"></column>
<column id="BILL_SERVICE_LINE_NO" label="Line#" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="10"></column>
<column id="SERVICE_LINE_DATE_VARCHAR" label="Date" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="10"></column>
<column id="PO_NO" label="PO" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="10"></column>
<column id="SERVICE_DESCRIPTION" label="Description" width="250" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textarea" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="200"></column>
<column id="BillingComment" label="Billing Comment" width="250" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="RESOURCE_NAME" label="Resource" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="10"></column>
<column id="ITEM_ID" label="Item Name" width="250" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="listbox" visible="True" format="" labelField="ITEM_NAME" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="200">
<dataSelect><![CDATA[-- ##IGNOREFORFILTERING##
declare @useridval bigint; 
select @useridval=UserId from dbo.AspNetUsers where username = @__LoginId__; 
exec dbo.[Billing_WorkCodeForTEG_Select] @JOBID=@BILL_JOB_ID, @UserId=@useridval]]></dataSelect></column>
<column id="ITEM_NAME" label="Item Name (hidden)" width="250" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textarea" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="200"></column>
<column id="BILL_QTY" label="Bill Hours" width="100" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="#,##0.00" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="True" defaultFilter="" filterText="" size="10"></column>
<column id="BILL_RATE" label="Bill Rate" width="100" editable="True" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="$" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="0.00" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="200"></column>
<column id="BILL_HOURLY_TOTAL" label="Labor Amt" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="$" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="#,##0.00" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="True" defaultFilter="" filterText="" size="200"></column>
<column id="BILL_EXP_TOTAL" label="Exp Amt" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="$" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="#,##0.00" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="True" defaultFilter="" filterText="" size="10"></column>
<column id="BILL_SERVICE_ID" label="SERVICE ID" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="200"></column>
<column id="SERVICE_LINE_ID" label="SERVICE LINE ID" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="200"></column>
<column id="INVOICE_LINE_ID" label="INVOICE_LINE_ID" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="BILL_TOTAL" label="Total" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="$" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="#,##0.00" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="True" defaultFilter="" filterText="" size="0"></column>
<column id="SUM_PAYROLL_QTY" label="TE Hours" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="#,##0.00" labelField="" dataSelect="" dataSelectCacheOnClient="True" preloadDataSelect="False" totalize="True" defaultFilter="" filterText="" size="10"></column>
<column id="DATE_CREATED" label="DATE CREATED" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="calendar" visible="True" format="MM/dd/yyyy" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="CREATEDBYUSERNAME" label="CREATED BY" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="DATE_MODIFIED" label="DATE MODIFIED" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="calendar" visible="True" format="MM/dd/yyyy" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="MODIFIEDBYUSERNAME" label="MODIFIED BY" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="True" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="True" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column>
<column id="item_type_code" label="Item Type" width="100" editable="False" filterable="True" filterItemsSize="100" resizable="False" customizable="True" labelPrefix="" labelSuffix="" align="left" headerAlign="left" editorType="textbox" visible="False" format="" labelField="" dataSelect="" dataSelectCacheOnClient="False" preloadDataSelect="False" totalize="False" defaultFilter="" filterText="" size="0"></column></columns>
        <sqlColumns><![CDATA[]]></sqlColumns>
        <sqlTemplateEdit><![CDATA[]]></sqlTemplateEdit>
        <sqlGridProperties><![CDATA[]]></sqlGridProperties>
    </grid>
</config>